//
// Recommended setings, mostly from following sources
// https://vikingvpn.com/cybersecurity-wiki/browser-security/guide-hardening-mozilla-firefox-for-privacy-and-security
// https://vox.space/blog/98/mozilla-firefox-security
// https://www.privacytools.io/#browser

lockPref("security.tls.version.min", 3);
lockPref("security.mixed_content.block_display_content", true);
lockPref("security.OCSP.require", true);
lockPref("security.ssl.require_safe_negotiation", true);
lockPref("security.ssl.treat_unsafe_negotiation_as_broken", true);

lockPref("security.ssl3.rsa_aes_256_sha", false);
lockPref("security.ssl3.rsa_rc4_128_md5", false);
lockPref("security.ssl3.rsa_rc4_128_sha", false);
lockPref("security.ssl3.rsa_des_ede3_sha", false);
lockPref("security.ssl3.ecdhe_ecdsa_rc4_128_sha", false);
lockPref("security.ssl3.ecdhe_rsa_rc4_128_sha", false);

lockPref("dom.battery.enabled", false);
lockPref("network.http.speculative-parallel-limit", 0);
lockPref("media.peerconnection.enabled", false);
lockPref("media.peerconnection.identity.enabled", false);
lockPref("media.peerconnection.simulcast", false);
lockPref("media.peerconnection.turn.disable", true);
lockPref("media.peerconnection.use_document_iceservers", false);
lockPref("media.peerconnection.video.enabled", false);

lockPref("webgl.disabled", true);
lockPref("camera.control.face_detection.enabled", false);
lockPref("device.sensors.enabled", false);
lockPref("dom.event.contextmenu.enabled", false);
lockPref("dom.event.clipboardevents.enabled", false);

lockPref("accessibility.blockautorefresh", true);
lockPref("devtools.remote.wifi.scan", false);
lockPref("geo.enabled", false);
lockPref("browser.search.geoSpecificDefaults", false);
lockPref("geo.wifi.uri", "");
lockPref("browser.geolocation.warning.infoURL", "");
lockPref("browser.search.geoSpecificDefaults.url", "");
lockPref("browser.search.geoip.url", "");
lockPref("beacon.enabled", false);
lockPref("dom.gamepad.enabled", false);
lockPref("services.sync.sendVersionInfo", false);
lockPref("extensions.pocket.enabled", false);
lockPref("media.eme.enabled", false);
lockPref("browser.send_pings", false);

lockPref("toolkit.telemetry.unified", false);
lockPref("toolkit.telemetry.server", "");
lockPref("experiments.manifest.uri", "");
lockPref("toolkit.telemetry.archive.enabled", false);
lockPref("toolkit.telemetry.enabled", false);
lockPref("datareporting.healthreport.uploadEnabled", false);
lockPref("datareporting.policy.dataSubmissionEnabled", false);
lockPref("browser.safebrowsing.enabled", false);
lockPref("browser.safebrowsing.downloads.enabled", false);
lockPref("browser.safebrowsing.malware.enabled", false);

lockPref("social.remote-install.enabled", false);
lockPref("social.toast-notifications.enabled", false);
lockPref("social.directories", "");
lockPref("social.whitelist", "");

lockPref("network.dns.disablePrefetch", true);
lockPref("privacy.trackingprotection.enabled", true);
lockPref("browser.fixup.alternate.enabled", false);
lockPref("browser.newtabpage.directory.source", "");
lockPref("browser.newtabpage.directory.ping", "");
lockPref("browser.formfill.enable", false);

lockPref("network.cookie.lifetimePolicy", 2);
lockPref("network.cookie.cookieBehavior", 1);
lockPref("plugin.scan.plid.all", false);
lockPref("browser.cache.disk.enable", false);
lockPref("browser.cache.disk_cache_ssl", false);
lockPref("browser.cache.offline.enable", false);

// lockPref("network.http.sendRefererHeader", 0);
// lockPref("network.http.referer.XOriginPolicy", 1);
// lockPref("network.http.referer.spoofSource", true);
// lockPref("network.http.referer.trimmingPolicy", 2);
// lockPref("privacy.donottrackheader.enabled", true);
